<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chosen Palette: Calm Neutrals with Emerald Accents -->
    <!-- Application Structure Plan: The SPA is structured as a multi-section "Financial Insights Dashboard." It starts with a welcoming "Hero" section. A sticky top navigation bar allows direct jumps to major sections: "Stock Market Intelligence," "Investment Strategies," "Business Payment Solutions," and "Cash Flow Analysis." Each major section contains sub-sections with specific interactive elements or visualizations. This modular, scrollable design with clear navigation was chosen to organize diverse financial topics from multiple reports into a single, cohesive, and easily explorable experience, making it suitable for sharing and quick consumption. -->
    <!-- Visualization & Content Choices: 
        - Stock Market Fundamentals: Interactive cards for macro/micro factors and financial terms. Goal: Inform & Organize. Viz: HTML/CSS styled cards with click-to-reveal details. Justification: Engaging and space-efficient. NO SVG.
        - Stock Market Top Performers: Static cards. Goal: Inform. Viz: HTML/CSS styled cards. Justification: Clear summary of key data. NO SVG.
        - Stock Market Deep Dive: Interactive stock selector, line chart for trend, table for financials, bar chart for forecast. Goal: Change, Compare, Inform. Viz: Chart.js line/bar charts, HTML table. Interaction: Button selection, simulated data refresh. Justification: Provides dynamic, detailed analysis. NO SVG.
        - Investment Asset Explorer: Bubble chart for risk-return, filterable asset cards. Goal: Relationships, Organize. Viz: Chart.js bubble chart, HTML/CSS cards. Interaction: Filters, click-to-reveal. Justification: Visualizes complex relationships and allows drill-down. NO SVG.
        - Investment Portfolio Designer: Income-based portfolio selector, donut charts for allocation. Goal: Inform, Compare. Viz: Chart.js donut charts. Interaction: Button selection. Justification: Personalized and actionable advice. NO SVG.
        - Payment Gateway Essentials: Flow diagram. Goal: Organize. Viz: HTML/CSS diagram. Justification: Clearly illustrates a process. NO SVG/Mermaid.
        - Payment Gateway Recommendations: Cards with AI insights button. Goal: Inform. Viz: HTML/CSS cards, dynamic text. Interaction: AI button calls LLM. Justification: Provides concise, on-demand summaries. NO SVG.
        - Payment Gateway EMI Strategy: Flow diagram. Goal: Organize. Viz: HTML/CSS diagram. Justification: Explains a process simply. NO SVG/Mermaid.
        - Cash Flow Analysis: Definitions in tabs, hypothetical company CFS (table), sectoral trends (bar chart). Goal: Inform, Compare. Viz: HTML tabs, HTML table, Chart.js bar chart. Justification: Breaks down complex accounting into digestible parts and shows comparative trends. NO SVG.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <title>Financial Insights Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f4f5f7; color: #1f2937; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 400px; max-height: 50vh; }
        .small-chart-container { position: relative; width: 100%; max-width: 400px; margin: 1rem auto; height: 200px; }
        .nav-link.active { color: #047857; border-bottom-color: #047857; }
        .selector-btn.active { background-color: #047857; color: white; }
        .card-reveal-btn { background-color: #e0e7e1; color: #047857; padding: 0.3rem 0.8rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; transition: background-color 0.2s; }
        .card-reveal-btn:hover { background-color: #c8d6ce; }
        .tab-btn.active { background-color: #047857; color: white; }
    </style>
</head>
<body class="antialiased">

    <header class="sticky top-0 bg-white/90 backdrop-blur-sm z-50 shadow-md">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-emerald-800">Financial Insights Dashboard</h1>
            <div class="hidden md:flex items-center space-x-6">
                <a href="#stock-market" class="nav-link text-gray-600 hover:text-emerald-700 pb-1 border-b-2 border-transparent transition-colors">Stock Market</a>
                <a href="#investments" class="nav-link text-gray-600 hover:text-emerald-700 pb-1 border-b-2 border-transparent transition-colors">Investments</a>
                <a href="#payments" class="nav-link text-gray-600 hover:text-emerald-700 pb-1 border-b-2 border-transparent transition-colors">Payments</a>
                <a href="#cash-flow" class="nav-link text-gray-600 hover:text-emerald-700 pb-1 border-b-2 border-transparent transition-colors">Cash Flow</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8 space-y-20">

        <section id="hero" class="text-center py-10">
            <h2 class="text-4xl md:text-5xl font-extrabold text-gray-800">Your Comprehensive Financial Insights Hub</h2>
            <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Navigate the complexities of stock markets, investment strategies, business payments, and cash flow analysis with interactive tools and clear explanations.</p>
        </section>

        <!-- STOCK MARKET INTELLIGENCE SECTION -->
        <section id="stock-market" class="bg-white p-6 rounded-2xl shadow-lg">
            <h3 class="text-3xl font-bold text-center text-emerald-800 mb-10">Stock Market Intelligence</h3>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">Dive into the dynamics of the stock market, from fundamental drivers to individual stock performance and future forecasts. Understand what moves the market and how to analyze companies.</p>

            <div class="space-y-16">
                <!-- Market Fundamentals -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Market Fundamentals Explained</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 text-center">
                        <div class="bg-gray-50 p-6 rounded-xl shadow-md">
                            <div class="text-4xl mb-3">üìà</div>
                            <h5 class="text-xl font-semibold mb-2">Significance of the Market</h5>
                            <p class="text-sm text-gray-600">The stock market is vital for individual wealth creation and national economic growth, enabling companies to raise capital for expansion and innovation. India's market is buoyed by 6-8% annual GDP growth and a surge in retail investors, enhancing its resilience.</p>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-xl shadow-md">
                            <div class="text-4xl mb-3">‚öñÔ∏è</div>
                            <h5 class="text-xl font-semibold mb-2">Regulatory Body: SEBI</h5>
                            <p class="text-sm text-gray-600">The Securities and Exchange Board of India (SEBI) is the primary regulator, protecting investors and ensuring market integrity. It has driven key reforms like dematerialization and faster settlement cycles, making markets more efficient and secure.</p>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-xl shadow-md">
                            <div class="text-4xl mb-3">üìä</div>
                            <h5 class="text-xl font-semibold mb-2">Key Indices</h5>
                            <p class="text-sm text-gray-600">Indices like the **Nifty 50** (NSE) and **BSE Sensex** are crucial barometers of market health, tracking the performance of the largest and most liquid Indian companies. They serve as benchmarks for the overall economy's performance.</p>
                        </div>
                    </div>
                </div>

                <!-- Top Performers -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Top Performers of FY 2023-24 (Historical)</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">These companies demonstrated exceptional performance during the Fiscal Year 2023-24 (April 2023 - March 2024), driven by strong fundamentals and strategic execution.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6">
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Trent Ltd.</h5><p class="text-3xl font-bold text-green-600">133.17%</p><p class="text-xs text-gray-500">Retail expansion</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">M&M Ltd.</h5><p class="text-3xl font-bold text-green-600">73.88%</p><p class="text-xs text-gray-500">EV push, SUV dominance</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">BEL</h5><p class="text-3xl font-bold text-green-600">59.15%</p><p class="text-xs text-gray-500">Defense spending</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Bharti Airtel</h5><p class="text-3xl font-bold text-green-600">53.82%</p><p class="text-xs text-gray-500">Subscriber growth</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Sun Pharma</h5><p class="text-3xl font-bold text-green-600">49.78%</p><p class="text-xs text-gray-500">Specialty segment lead</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Shriram Finance</h5><p class="text-2xl font-bold text-green-600">40.71%</p><p class="text-xs text-gray-500">Strategic deals</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">BPCL</h5><p class="text-2xl font-bold text-green-600">29.79%</p><p class="text-xs text-gray-500">Greenfield projects</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Waaree Energies</h5><p class="text-2xl font-bold text-green-600">>100%</p><p class="text-xs text-gray-500">IPO Gain, PAT surge</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Premier Energies</h5><p class="text-2xl font-bold text-green-600">>100%</p><p class="text-xs text-gray-500">IPO Gain, Revenue growth</p></div>
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md text-center"><h5 class="font-bold">Bharti Hexacom</h5><p class="text-2xl font-bold text-green-600">>100%</p><p class="text-xs text-gray-500">IPO Gain, ROCE improv.</p></div>
                    </div>
                </div>

                <!-- Stock Deep Dive -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Stock Deep Dive & Forecast</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8">Select a stock to explore its historical performance, key financials, and future projections. Data for "Current" performance is simulated to provide a dynamic feel. Click "Refresh Data" for a new simulated update.</p>
                    
                    <div id="stock-selector" class="flex justify-center flex-wrap gap-2 mb-8"></div>

                    <div id="stock-display-area" class="bg-gray-50 p-6 rounded-2xl shadow-xl min-h-[500px]">
                        <div class="flex justify-between items-center mb-4">
                            <h5 id="stock-name" class="text-xl font-bold text-gray-800">Select a Stock</h5>
                            <div>
                                <span id="last-updated" class="text-xs text-gray-500 mr-2"></span>
                                <button onclick="refreshCurrentStockData()" class="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-sm hover:bg-emerald-200 transition-colors">Refresh Data</button>
                            </div>
                        </div>
                        <p id="stock-description" class="text-sm text-gray-600 mb-6">Details will appear here.</p>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h6 class="text-lg font-semibold text-gray-700 mb-2">Performance Trend (5Y)</h6>
                                <div class="chart-container">
                                    <canvas id="performanceChart"></canvas>
                                </div>
                            </div>
                            <div>
                                <h6 class="text-lg font-semibold text-gray-700 mb-2">Key Financials</h6>
                                <div id="financials-table-container" class="overflow-x-auto"></div>
                                <h6 class="text-lg font-semibold text-gray-700 mt-6 mb-2">2-Year Forecast</h6>
                                <div id="forecast-container"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- INVESTMENT STRATEGIES SECTION -->
        <section id="investments" class="bg-white p-6 rounded-2xl shadow-lg">
            <h3 class="text-3xl font-bold text-center text-emerald-800 mb-10">Investment Strategies & Portfolio Design</h3>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">Understand various asset classes and design personalized investment portfolios. This section equips you with the knowledge to make informed decisions for your financial growth.</p>

            <div class="space-y-16">
                <!-- Asset Explorer -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Asset Explorer: Risk-Return Landscape</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">Visualize the inherent trade-off between risk and potential return across various Indian asset classes. Filter by category to explore specific investment types.</p>
                    <div class="chart-container">
                        <canvas id="riskReturnChart"></canvas>
                    </div>
                    <div class="flex justify-center flex-wrap gap-2 mt-8">
                        <button onclick="filterAssets('all')" class="selector-btn bg-emerald-700 text-white px-4 py-2 rounded-full">All</button>
                        <button onclick="filterAssets('Equity')" class="selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Equity</button>
                        <button onclick="filterAssets('Debt')" class="selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Debt</button>
                        <button onclick="filterAssets('Real Estate')" class="selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Real Estate</button>
                        <button onclick="filterAssets('Alternative')" class="selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Alternatives</button>
                    </div>
                    <div id="asset-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-8"></div>
                </div>

                <!-- Portfolio Designer -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Personalized Portfolio Designer</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">Select your annual income to view tailored investment portfolios. Each portfolio is designed with logical reasoning to align with typical financial goals and risk appetites for that income bracket.</p>
                    <div class="flex justify-center flex-wrap gap-3 mb-8">
                        <button onclick="showPortfolio('10L')" class="portfolio-tab selector-btn active px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ10 Lakhs</button>
                        <button onclick="showPortfolio('15L')" class="portfolio-tab selector-btn bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ15 Lakhs</button>
                        <button onclick="showPortfolio('20L')" class="portfolio-tab selector-btn bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ20 Lakhs</button>
                        <button onclick="showPortfolio('30L')" class="portfolio-tab selector-btn bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ30 Lakhs</button>
                        <button onclick="showPortfolio('50L')" class="portfolio-tab selector-btn bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ50 Lakhs</button>
                        <button onclick="showPortfolio('1Cr')" class="portfolio-tab selector-btn bg-gray-200 text-gray-700 px-5 py-2 rounded-full font-semibold transition-colors duration-300">‚Çπ1 Crore</button>
                    </div>
                    <div id="portfolio-display" class="bg-gray-50 rounded-xl p-6"></div>
                </div>
            </div>
        </section>

        <!-- BUSINESS PAYMENT SOLUTIONS SECTION -->
        <section id="payments" class="bg-white p-6 rounded-2xl shadow-lg">
            <h3 class="text-3xl font-bold text-center text-emerald-800 mb-10">Business Payment Solutions</h3>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">For businesses, optimizing payment infrastructure is crucial. This section covers the fundamentals of payment gateways, provides strategic recommendations, and details an effective EMI strategy to boost sales.</p>

            <div class="space-y-16">
                <!-- Payment Gateway Essentials -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">What is a Payment Gateway?</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">A payment gateway securely connects customers, businesses, and banks, encrypting sensitive data and managing the complex flow of information for online transactions. It's the digital cashier of e-commerce.</p>
                    <div class="bg-gray-100 text-gray-800 rounded-xl p-6">
                        <h5 class="text-xl font-bold text-center mb-6">The Secure Transaction Flow</h5>
                        <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4 text-center">
                            <div class="flex-1 p-4 bg-white rounded-lg shadow-sm"><div class="text-4xl mb-2">üí≥</div><h6 class="font-semibold">1. Customer Pays</h6><p class="text-xs">Submits card details.</p></div>
                            <div class="text-3xl text-gray-400 font-light">&rarr;</div>
                            <div class="flex-1 p-4 bg-white rounded-lg shadow-sm"><div class="text-4xl mb-2">üîê</div><h6 class="font-semibold">2. Gateway Encrypts</h6><p class="text-xs">Data secured & sent.</p></div>
                            <div class="text-3xl text-gray-400 font-light">&rarr;</div>
                            <div class="flex-1 p-4 bg-white rounded-lg shadow-sm"><div class="text-4xl mb-2">üè¶</div><h6 class="font-semibold">3. Bank Authorizes</h6><p class="text-xs">Issuing bank approves.</p></div>
                            <div class="text-3xl text-gray-400 font-light">&rarr;</div>
                            <div class="flex-1 p-4 bg-white rounded-lg shadow-sm"><div class="text-4xl mb-2">‚úÖ</div><h6 class="font-semibold">4. Confirmation</h6><p class="text-xs">Response to customer.</p></div>
                        </div>
                    </div>
                </div>

                <!-- Top Gateway Recommendations -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Top 3 Recommendations for Outlook Group</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">Based on comprehensive analysis, these gateways are recommended for robust subscription management, strong Indian market presence, and flexible EMI strategies. Click "Get AI Insights" for a quick summary.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="bg-emerald-50 border-2 border-emerald-200 p-6 rounded-lg text-center">
                            <div class="text-3xl font-bold text-emerald-700 mb-2">#1</div>
                            <h5 class="text-xl font-bold text-gray-800">Razorpay</h5>
                            <p class="mt-2 text-sm text-gray-600">Unmatched support for Indian payment methods, comprehensive EMI options, developer-friendly platform for subscriptions.</p>
                            <button class="mt-4 bg-emerald-600 text-white font-bold py-2 px-4 rounded-full hover:bg-emerald-700 transition-colors duration-300" onclick="getAiInsights('Razorpay', 'Leading Indian payment gateway, known for robust support for local payment methods and developer-friendly APIs.', 'Comprehensive EMI options (Credit, Debit, Cardless), subscription management, instant settlements, broad payment method acceptance (UPI, Netbanking, Wallets).', 'Excellent for Indian market, strong EMI features, good developer tools, reliable support.', 'Primarily India-focused, international reach less extensive than global players.')">‚ú® Get AI Insights</button>
                            <div id="razorpayInsights" class="mt-4 text-left text-sm bg-emerald-100 p-3 rounded-lg hidden"></div>
                        </div>
                        <div class="bg-blue-50 border-2 border-blue-200 p-6 rounded-lg text-center">
                            <div class="text-3xl font-bold text-blue-600 mb-2">#2</div>
                            <h5 class="text-xl font-bold text-gray-800">Stripe</h5>
                            <p class="mt-2 text-sm text-gray-600">Ideal for future global expansion. Offers powerful, highly customizable APIs and extensive multi-currency support, providing a scalable foundation for growth.</p>
                            <button class="mt-4 bg-emerald-600 text-white font-bold py-2 px-4 rounded-full hover:bg-emerald-700 transition-colors duration-300" onclick="getAiInsights('Stripe', 'Global technology company building economic infrastructure for the internet. Offers highly customizable payment processing solutions.', 'Global reach, extensive API suite, recurring billing, fraud prevention, multi-currency support, BNPL integrations.', 'Highly flexible, excellent for global expansion, strong developer community, advanced features.', 'Can be complex for small businesses, higher fees for some international transactions, less focus on India-specific payment methods.')">‚ú® Get AI Insights</button>
                            <div id="stripeInsights" class="mt-4 text-left text-sm bg-blue-100 p-3 rounded-lg hidden"></div>
                        </div>
                        <div class="bg-indigo-50 border-2 border-indigo-200 p-6 rounded-lg text-center">
                            <div class="text-3xl font-bold text-indigo-600 mb-2">#3</div>
                            <h5 class="text-xl font-bold text-gray-800">Paytm PG</h5>
                            <p class="mt-2 text-sm text-gray-600">Leverages a massive, trusting user base in India. Offers excellent, cost-effective domestic transaction processing and strong EMI/subscription features.</p>
                            <button class="mt-4 bg-emerald-600 text-white font-bold py-2 px-4 rounded-full hover:bg-emerald-700 transition-colors duration-300" onclick="getAiInsights('Paytm', 'Prominent Indian digital payments platform with a large user base, offering payment gateway services.', 'UPI Autopay, wallet integration, quick activation, cost-effective domestic transactions, wide acceptance among Indian consumers.', 'Massive Indian user base, cost-effective for domestic transactions, easy integration, good for mobile-first approach.', 'Less global presence, customer support can be challenging, primarily focused on the Indian market.')">‚ú® Get AI Insights</button>
                            <div id="paytmInsights" class="mt-4 text-left text-sm bg-indigo-100 p-3 rounded-lg hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- EMI Strategy -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Strategy Spotlight: Selling Subscriptions with EMI</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">An Equated Monthly Installment (EMI) strategy makes higher-value annual subscriptions more affordable, significantly boosting conversion rates by breaking down the cost into manageable payments.</p>
                    <div class="max-w-4xl mx-auto p-6 bg-gray-100 rounded-xl">
                        <div class="flex flex-col md:flex-row items-center justify-around space-y-6 md:space-y-0 text-center">
                            <div class="flex-1"><div class="text-4xl text-emerald-700 mb-2">‚ë†</div><h6 class="font-semibold text-lg">Customer Selects EMI</h6><p class="text-sm">Chooses a long-term plan and EMI option.</p></div>
                            <div class="text-3xl text-gray-400 font-light">&rarr;</div>
                            <div class="flex-1"><div class="text-4xl text-emerald-700 mb-2">‚ë°</div><h6 class="font-semibold text-lg">Bank Pays Upfront</h6><p class="text-sm">The bank pays the full subscription amount to the business immediately.</p></div>
                            <div class="text-3xl text-gray-400 font-light">&rarr;</div>
                            <div class="flex-1"><div class="text-4xl text-emerald-700 mb-2">‚ë¢</div><h6 class="font-semibold text-lg">Customer Repays Bank</h6><p class="text-sm">The customer repays the bank in small, fixed monthly installments.</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CASH FLOW ANALYSIS SECTION -->
        <section id="cash-flow" class="bg-white p-6 rounded-2xl shadow-lg">
            <h3 class="text-3xl font-bold text-center text-emerald-800 mb-10">Cash Flow Analysis</h3>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">Understand the lifeblood of a company: its cash flow. This section breaks down the components of a cash flow statement, explains its significance, and provides insights into how different sectors manage their cash.</p>

            <div class="space-y-16">
                <!-- Understanding Cash Flow -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Understanding Cash Flow: The Company's Lifeblood</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">Cash flow analysis assesses a company's ability to generate and use cash, providing a true picture of its financial health beyond just profits. It's crucial for evaluating liquidity, solvency, and operational efficiency.</p>
                    <div class="flex justify-center flex-wrap gap-2 mb-6">
                        <button onclick="showCashFlowDefinition('operations')" id="tab-operations" class="tab-btn selector-btn px-4 py-2 rounded-full">Operations</button>
                        <button onclick="showCashFlowDefinition('investing')" id="tab-investing" class="tab-btn selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Investing</button>
                        <button onclick="showCashFlowDefinition('financing')" id="tab-financing" class="tab-btn selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Financing</button>
                        <button onclick="showCashFlowDefinition('free')" id="tab-free" class="tab-btn selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Free Cash Flow</button>
                        <button onclick="showCashFlowDefinition('positive_negative')" id="tab-positive_negative" class="tab-btn selector-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Positive/Negative</button>
                    </div>
                    <div id="cash-flow-definition-content" class="bg-gray-50 p-6 rounded-xl shadow-md">
                        <h5 class="text-xl font-semibold text-gray-800 mb-3">Cash Flow from Operations (CFO)</h5>
                        <p class="text-gray-700 text-sm">This represents the cash generated from a company's normal business activities. It indicates how much cash the company produces from its core operations, excluding non-cash expenses like depreciation. A strong positive CFO is a sign of healthy, sustainable business operations.</p>
                    </div>
                </div>

                <!-- Hypothetical Company Analysis -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Hypothetical Company: Cash Flow Snapshot (FY23-24)</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">This simplified cash flow statement illustrates a hypothetical company's cash movements. Analyze these figures to understand its financial position and strategic focus.</p>
                    <div class="overflow-x-auto bg-gray-50 p-6 rounded-xl shadow-md">
                        <table class="w-full text-sm text-left text-gray-700">
                            <thead class="text-xs text-gray-900 uppercase bg-gray-100">
                                <tr><th scope="col" class="px-4 py-2">Metric</th><th scope="col" class="px-4 py-2">FY 2023 (‚Çπ Cr)</th><th scope="col" class="px-4 py-2">FY 2024 (‚Çπ Cr)</th></tr>
                            </thead>
                            <tbody>
                                <tr class="bg-white border-b"><td class="px-4 py-2 font-semibold">Cash Flow from Operations (CFO)</td><td class="px-4 py-2 text-green-600">+150</td><td class="px-4 py-2 text-green-600">+180</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-4 py-2 font-semibold">Cash Flow from Investing (CFI)</td><td class="px-4 py-2 text-red-600">-80</td><td class="px-4 py-2 text-red-600">-120</td></tr>
                                <tr class="bg-white border-b"><td class="px-4 py-2 font-semibold">Cash Flow from Financing (CFF)</td><td class="px-4 py-2 text-green-600">+20</td><td class="px-4 py-2 text-red-600">-30</td></tr>
                                <tr class="bg-gray-50"><td class="px-4 py-2 font-semibold">Net Change in Cash</td><td class="px-4 py-2 text-green-600">+90</td><td class="px-4 py-2 text-green-600">+30</td></tr>
                            </tbody>
                        </table>
                        <p class="mt-4 text-xs text-gray-600">This company shows strong operational cash generation, indicating healthy core business. Increased investing outflow in FY24 suggests expansion, while the shift in financing from inflow to outflow (e.g., debt repayment) points to financial deleveraging.</p>
                    </div>
                </div>

                <!-- Sectoral Cash Flow Trends -->
                <div>
                    <h4 class="text-2xl font-semibold text-gray-700 mb-6 text-center">Sectoral Cash Flow Trends (Simulated FY24 CFO Growth)</h4>
                    <p class="text-center text-gray-600 max-w-3xl mx-auto mb-8 text-sm">Different sectors exhibit unique cash flow patterns. This chart illustrates simulated year-on-year growth in Cash Flow from Operations (CFO) for key Indian sectors, reflecting their typical business models.</p>
                    <div class="chart-container">
                        <canvas id="sectoralCashFlowChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="mt-20 bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center text-sm text-gray-400">
            <p>This dashboard is for informational purposes only and does not constitute financial advice.</p>
            <p class="mt-1">All data (except for historical top performers) is simulated or illustrative. Always consult with a qualified professional before making financial decisions.</p>
            <p class="mt-4">Built with Tailwind CSS & Chart.js. No SVG or Mermaid JS used.</p>
        </div>
    </footer>

    <script>
        // --- GLOBAL CHART CONFIG ---
        const chartJsTooltipConfig = {
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) { return label.join(' '); }
                            return label;
                        }
                    }
                }
            }
        };

        // --- STOCK MARKET DATA & LOGIC ---
        const stockData = {
            'INDUS': { name: 'Indusind Bank', description: 'Prominent private sector bank facing recent headwinds due to microfinance exposure. Strategic focus is on improving retail deposits and asset quality.', trend: [100, 115, 130, 95, 105, 100], financials: { headers: ['Metric', 'FY24', 'FY25'], rows: [['NII (‚ÇπCr)', '15,239 (9M)', '15,983 (9M)'], ['PAT (‚ÇπCr)', '6,628 (9M)', '4,904 (9M)'], ['NIM (%)', '4.29 (Q3)', '3.93 (Q3)'], ['EPS (‚Çπ)', 'N/A', '33.07']]}, forecast: { label: 'Return on Assets', past: 'N/A', future: '1%', unit: '%' } },
            'AXIS': { name: 'Axis Bank', description: 'One of India\'s largest private banks with strong growth in digital banking and an expanding branch network. Asset quality is consistently improving.', trend: [100, 120, 145, 160, 170, 180], financials: { headers: ['Metric', 'FY24', 'FY25'], rows: [['NII (‚ÇπCr)', '49,894', '54,348'], ['PAT (‚ÇπCr)', '24,861', '26,373'], ['NIM (%)', '4.07', '3.98'], ['ROE (%)', '19.29', '16.89']]}, forecast: { label: 'Analyst Target', past: '1150', future: '1330', unit: '‚Çπ' } },
            'RBL': { name: 'RBL Bank', description: 'Private sector bank focusing on strengthening its balance sheet and diversifying its retail asset mix. Shows strong growth forecasts despite recent profit dips.', trend: [100, 80, 60, 90, 110, 130], financials: { headers: ['Metric', 'FY23', 'FY25'], rows: [['NII (‚ÇπCr)', '4,900', '4,900 (9M)'], ['PAT (‚ÇπCr)', '883', '-70.47%'], ['NIM (%)', '5.19', '3.43'], ['ROE (%)', '14.72', '4.73']]}, forecast: { label: 'Earnings Growth/yr', past: 'N/A', future: '34.5', unit: '%' } },
            'MOTHERSO': { name: 'Motherson (SAMIL)', description: 'Global automotive components manufacturer demonstrating resilience by outpacing industry growth through acquisitions and new facilities. Strong booked business value.', trend: [100, 130, 110, 150, 190, 210], financials: { headers: ['Metric', 'FY23', 'FY24', 'FY25'], rows: [['Revenue (‚ÇπCr)', '78,701', '98,692', '113,663'], ['PAT (‚ÇπCr)', '1,496', '2,716', '3,803'], ['EBITDA (‚ÇπCr)', '6,394', '9,325', '10,877'], ['ROCE (%)', '10.8', '16.9', '17.2']]}, forecast: { label: 'Revenue (‚Çπ Bn, Next Qtr)', past: 'N/A', future: '305.52', unit: '' } },
            'CAMLINFINE': { name: 'Camlin Fine Sciences', description: 'Specialty chemicals company showing mixed performance with recent losses but improving EBITDA margins. Expected to benefit from rising Vanillin prices and debt reduction.', trend: [100, 150, 120, 80, 90, 110], financials: { headers: ['Metric', 'FY24', 'FY25'], rows: [['Revenue (‚ÇπCr)', '773', '886'], ['PAT (‚ÇπCr)', '-51', '-76'], ['EBITDA (‚ÇπCr)', '35', '71'], ['ROE (%)', '-12.2', '2.33']]}, forecast: { label: 'PAT (‚ÇπCr)', past: '-76', future: '131', unit: '' } },
            'RAMKFORG': { name: 'Ramkrishna Forgings', description: 'Leading forging player benefiting from strong demand in the commercial vehicle (CV) segment and export sales. Focus on new product development.', trend: [100, 200, 350, 400, 480, 550], financials: { headers: ['Metric', 'FY22', 'FY23'], rows: [['Revenue (‚ÇπLakh)', '2,28,536', '3,00,100'], ['PAT (‚ÇπLakh)', '20,650', '23,559'], ['EBITDA (‚ÇπLakh)', '52,857', '67,196'], ['ROE (%)', '20.82', '19.48']]}, forecast: { label: 'CV Sales Growth', past: 'N/A', future: '10', unit: '%' } },
            'HCC': { name: 'Hindustan Construction Co.', description: 'Infrastructure and engineering company focused on deleveraging and improving liquidity through strategic initiatives. Performance depends on order book execution.', trend: [100, 110, 80, 60, 50, 58], financials: { headers: ['Metric', 'FY23', 'FY24'], rows: [['Revenue (‚ÇπCr)', '5,222', '5,043'], ['PAT (‚ÇπCr)', '253', '178'], ['EBITDA (proxy) (‚ÇπCr)', '712', '687'], ['Order Book (‚ÇπCr)', 'N/A', '10,475']]}, forecast: { label: 'Order Inflow (FY24)', past: '0', future: '3816', unit: 'Cr' } },
            'TITAN': { name: 'Titan Company Ltd.', description: 'Diversified consumer lifestyle company with strong growth across Jewellery, Watches, and Eyewear. Expanding international footprint and maintaining healthy dividend payout.', trend: [100, 130, 180, 220, 250, 280], financials: { headers: ['Metric', 'FY24', 'FY25'], rows: [['Revenue (‚ÇπCr)', '47,501', '57,818'], ['PAT (‚ÇπCr)', '3,496', '3,337'], ['EBIT (‚ÇπCr)', 'N/A', '5,488'], ['ROE (%)', '31.8', 'N/A']]}, forecast: { label: 'Revenue Growth', past: 'N/A', future: 'Sustained', unit: '' } },
            'HAVELLS': { name: 'Havells India Ltd.', description: 'Leading Fast-Moving Electrical Goods (FMEG) company. Almost debt-free with strong market dominance, efficient working capital, and a healthy dividend payout.', trend: [100, 110, 130, 150, 165, 180], financials: { headers: ['Metric', 'Q4 FY24', 'Q4 FY25'], rows: [['Sales (‚ÇπCr)', '5,442', '6,544'], ['PAT (‚ÇπCr)', '447', '517'], ['Operating Profit (‚ÇπCr)', '635', '757'], ['ROE (FY25 %)', 'N/A', '18.8']]}, forecast: { label: 'Dividend Payout', past: 'N/A', future: '43.6', unit: '%' } }
        };

        let performanceChart = null;
        let forecastChart = null;
        let currentStockKey = 'MOTHERSO';

        function renderStockSelector() {
            const selectorContainer = document.getElementById('stock-selector');
            selectorContainer.innerHTML = Object.keys(stockData).map(key =>
                `<button onclick="displayStockDetails('${key}')" class="selector-btn px-4 py-2 text-sm font-semibold bg-white text-gray-700 rounded-full shadow-sm hover:bg-emerald-600 hover:text-white transition-colors duration-200">${stockData[key].name}</button>`
            ).join('');
        }

        function setActiveStockButton(stockKey) {
            document.querySelectorAll('#stock-selector .selector-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(stockData[stockKey].name)) {
                    btn.classList.add('active');
                }
            });
        }

        function updateLastUpdatedTimestamp() {
            const now = new Date();
            const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            document.getElementById('last-updated').textContent = `Last Updated: ${now.toLocaleDateString('en-US', options)}`;
        }

        function displayStockDetails(stockKey) {
            currentStockKey = stockKey;
            const data = stockData[stockKey];

            document.getElementById('stock-name').textContent = data.name;
            document.getElementById('stock-description').textContent = data.description;

            const trendData = [...data.trend];
            const lastValue = trendData[trendData.length - 1];
            const fluctuation = (Math.random() - 0.5) * 5;
            trendData[trendData.length - 1] = Math.max(0, lastValue + fluctuation);

            if (performanceChart) {
                performanceChart.destroy();
            }
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: ['2020', '2021', '2022', '2023', '2024', 'Current'],
                    datasets: [{
                        label: 'Relative Performance',
                        data: trendData,
                        borderColor: '#047857',
                        backgroundColor: 'rgba(5, 150, 105, 0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    ...chartJsTooltipConfig,
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: false } },
                    plugins: { ...chartJsTooltipConfig.plugins, legend: { display: false } }
                }
            });

            const finTableContainer = document.getElementById('financials-table-container');
            let tableHTML = `<table class="w-full text-sm text-left text-gray-500">
                <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                    <tr>${data.financials.headers.map(h => `<th scope="col" class="px-4 py-2">${h}</th>`).join('')}</tr>
                </thead>
                <tbody>`;
            data.financials.rows.forEach(row => {
                tableHTML += `<tr class="bg-white border-b">${row.map(cell => `<td class="px-4 py-2">${cell}</td>`).join('')}</tr>`;
            });
            tableHTML += `</tbody></table>`;
            finTableContainer.innerHTML = tableHTML;
            
            const forecastContainer = document.getElementById('forecast-container');
            const forecast = data.forecast;
            if(forecast.future !== 'Sustained'){
                forecastContainer.innerHTML = `<p class="text-sm text-gray-600 mb-2">${forecast.label} Forecast (FY26/27):</p>
                <div class="small-chart-container"><canvas id="forecastChart"></canvas></div>`;
                if(forecastChart) forecastChart.destroy();
                const forecastCtx = document.getElementById('forecastChart').getContext('2d');
                forecastChart = new Chart(forecastCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Past/Current', 'Forecast'],
                        datasets:[{
                            label: forecast.label,
                            data: [parseFloat(forecast.past) || 0, parseFloat(forecast.future)],
                            backgroundColor: ['#9ca3af', '#10b981']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                         plugins: { legend: { display: false } },
                         scales: { y: { ticks: { callback: (value) => value + forecast.unit }}}
                    }
                });
            } else {
                 forecastContainer.innerHTML = `<p class="text-sm text-center text-gray-600 mt-4 p-4 bg-gray-50 rounded-lg">Consistent revenue growth expected to continue based on strategic expansion and strong brand presence.</p>`;
            }

            setActiveStockButton(stockKey);
            updateLastUpdatedTimestamp();
        }

        function refreshCurrentStockData() {
            if (currentStockKey) {
                displayStockDetails(currentStockKey);
            }
        }

        // --- INVESTMENT DATA & LOGIC ---
        const assetData = [
            { name: "Large Cap Mutual Funds", risk: "Moderate", return: "10-12%", category: "Equity", details: "Invests in top 100 Indian companies. Relatively stable. Benchmarks: NIFTY 100. Top Performer: Nippon India Large Cap (17.88% 10Y SIP)." },
            { name: "Mid Cap Mutual Funds", risk: "Very High", return: "28.85% (5Y Avg)", category: "Equity", details: "Invests in companies 101-250. Higher growth, higher volatility. Benchmarks: Nifty Midcap 250. Top Performer: Motilal Oswal Midcap (33.4% 5Y)." },
            { name: "Small Cap Mutual Funds", risk: "Very High", return: "33.49% (5Y Avg)", category: "Equity", details: "Invests in companies beyond the top 250. Highest growth potential and volatility. Benchmarks: Nifty Smallcap 250. Top Performer: Quant Small Cap (45.51% 5Y)." },
            { name: "International Equities Funds", risk: "High", return: "21.37% (5Y, NASDAQ)", category: "Equity", details: "Provides global diversification. Currency and political risks. Benchmarks: S&P 500, Nasdaq 100. Top Performer: Motilal Oswal Nasdaq 100 FoF (21.37% 5Y)." },
            { name: "Fixed Deposits (FDs)", risk: "Very Low", return: "7-8%", category: "Debt", details: "Guaranteed returns from banks. Capital protection. Top Providers: SBI, HDFC Bank." },
            { name: "Public Provident Fund (PPF)", risk: "Very Low", return: "7.1%", category: "Debt", details: "Government-backed, tax-saving scheme. 15-year lock-in. Guaranteed returns." },
            { name: "National Savings Certificate", risk: "Low", return: "7.7%", category: "Debt", details: "Government-backed, 5-year fixed income instrument. Tax benefits under 80C." },
            { name: "Liquid & Short Duration Funds", risk: "Low", return: "7-8%", category: "Debt", details: "Invests in short-term debt. High liquidity, ideal for emergency funds. Benchmark: CRISIL Liquid Fund Index." },
            { name: "Corporate & Gilt Funds", risk: "Moderate", return: "10-11% (1Y Gilt)", category: "Debt", details: "Invests in corporate or government bonds. Moderate interest rate or credit risk. Benchmark: CRISIL Gilt Index." },
            { name: "Physical Real Estate", risk: "High", return: "9.5% (Commercial ROI)", category: "Real Estate", details: "Direct property ownership. High capital, illiquid, but offers rental income and appreciation." },
            { name: "REITs", risk: "Moderate", return: "17.9% (1Y India)", category: "Real Estate", details: "Liquid way to invest in income-generating real estate. Mandated dividends. Top Performer: Brookfield India REIT (26.5% Total Return)." },
            { name: "InvITs", risk: "Moderate", return: "14.6% (Yield)", category: "Real Estate", details: "Invests in infrastructure assets like roads, power lines. Provides stable income. Top Performer: PowerGrid InvIT (14.60% Yield)." },
            { name: "Gold ETFs", risk: "Moderate", return: "32.44% (1Y)", category: "Alternative", details: "Tracks gold prices. Acts as a hedge against inflation and market crises. Top Performer: IDBI Gold ETF (32.44% 1Y)." },
            { name: "Silver ETFs", risk: "High", return: "18.59% (1Y)", category: "Alternative", details: "Tracks silver prices. More volatile than gold due to industrial demand. Top Performer: Nippon India Silver ETF (18.59% 1Y)." },
            { name: "P2P Lending", risk: "High", return: "10-30%", category: "Alternative", details: "Direct lending to individuals. High returns but carries borrower default risk. Platforms: IndiaP2P." },
            { name: "AIFs", risk: "Very High", return: "High (VC Median)", category: "Alternative", details: "For HNIs. Invests in private equity, venture capital. Illiquid, complex. Top Performer: Abakkus." },
            { name: "Cryptocurrencies", risk: "Extremely High", return: "200%+", category: "Alternative", details: "Digital assets. Extreme volatility and risk of total loss. For speculative allocation only. Exchanges: WazirX, CoinDCX." },
            { name: "National Pension System (NPS)", risk: "Moderate", return: "8-10% (Avg)", category: "Debt", details: "Market-linked retirement scheme with tax benefits. Asset choice E, C, G. Top Performer: UTI Pension Fund (19.59% 1Y)." },
            { name: "Index Funds", risk: "High", return: "12-15%", category: "Equity", details: "Passively tracks a market index like Nifty 50. Low cost, reflects market returns. Top Performer: Invesco India NIFTY ETF (176.55% 5Y)." },
            { name: "Arbitrage Funds", risk: "Very Low", return: "6-8%", category: "Debt", details: "Exploits price differences between cash and futures markets. Market-neutral, low-risk returns." }
        ];
        const riskLevelMap = { 'Very Low': 1, 'Low': 2, 'Moderate': 3, 'High': 4, 'Very High': 5, 'Extremely High': 6 };

        function getRiskColorClass(risk) {
            switch (risk) {
                case 'Very Low': case 'Low': return 'bg-green-100 text-green-800';
                case 'Moderate': return 'bg-yellow-100 text-yellow-800';
                case 'High': return 'bg-orange-100 text-orange-800';
                case 'Very High': return 'bg-red-100 text-red-800';
                case 'Extremely High': return 'bg-purple-100 text-purple-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }
        
        function renderAssets(filter = 'all') {
            const grid = document.getElementById('asset-grid');
            grid.innerHTML = '';
            const filteredAssets = filter === 'all' ? assetData : assetData.filter(asset => asset.category === filter);

            filteredAssets.forEach(asset => {
                const card = document.createElement('div');
                card.className = 'bg-gray-50 rounded-lg p-6 shadow-md transition-transform duration-300 hover:scale-[1.02]';
                card.innerHTML = `
                    <h5 class="font-bold text-lg text-gray-800">${asset.name}</h5>
                    <div class="flex justify-between items-center mt-2">
                        <span class="text-xs font-semibold py-1 px-2 rounded-full ${getRiskColorClass(asset.risk)}">${asset.risk} Risk</span>
                        <span class="text-base font-bold text-emerald-700">${asset.return}</span>
                    </div>
                    <div class="asset-details hidden mt-4 pt-4 border-t border-gray-200">
                        <p class="text-sm text-gray-600">${asset.details}</p>
                    </div>
                    <button class="card-reveal-btn mt-4" onclick="this.previousElementSibling.classList.toggle('hidden'); this.textContent = this.textContent.includes('Show') ? 'Hide Details' : 'Show Details'; event.stopPropagation();">Show Details</button>
                `;
                grid.appendChild(card);
            });
        }
        
        function filterAssets(category) {
            renderAssets(category);
            document.querySelectorAll('#investments .selector-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            document.querySelector(`#investments .selector-btn[onclick="filterAssets('${category}')"]`).classList.add('active');
            document.querySelector(`#investments .selector-btn[onclick="filterAssets('${category}')"]`).classList.remove('bg-gray-200', 'text-gray-700');
        }

        let riskReturnChart = null;
        function renderRiskReturnChart() {
            const ctx = document.getElementById('riskReturnChart').getContext('2d');
            const dataForChart = assetData.map(asset => ({
                x: riskLevelMap[asset.risk] + (Math.random() - 0.5) * 0.4, 
                y: parseFloat(asset.return) || 10,
                r: (parseFloat(asset.return) || 10) / 2 + 5,
                label: asset.name,
                riskLabel: asset.risk,
            }));

            if (riskReturnChart) riskReturnChart.destroy();
            riskReturnChart = new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'Asset Classes',
                        data: dataForChart,
                        backgroundColor: dataForChart.map(d => {
                            if (d.riskLabel.includes('High')) return 'rgba(239, 68, 68, 0.6)';
                            if (d.riskLabel.includes('Moderate')) return 'rgba(245, 158, 11, 0.6)';
                            if (d.riskLabel.includes('Low')) return 'rgba(34, 197, 94, 0.6)';
                            return 'rgba(107, 114, 128, 0.6)';
                        }),
                        borderColor: 'rgba(0,0,0,0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'Risk Profile', font: { size: 14 } },
                            ticks: {
                                callback: (value) => Object.keys(riskLevelMap).find(key => riskLevelMap[key] === Math.round(value)) || '',
                                stepSize: 1
                            },
                            grid: { display: false }
                        },
                        y: {
                            type: 'logarithmic',
                            title: { display: true, text: 'Expected Return (%)', font: { size: 14 } },
                            ticks: { callback: function(value) { if ([5, 10, 20, 50, 100, 200].includes(value)) return value + '%'; } }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const dataPoint = context.chart.data.datasets[0].data[context.dataIndex];
                                    return `${dataPoint.label}: ${dataPoint.riskLabel} Risk, ~${dataPoint.y}% Return`;
                                }
                            }
                        }
                    }
                }
            });
        }

        const portfolioData = {
            '10L': [
                { title: 'Moderate Growth & Tax-Optimized', data: { labels: ['Equity MF (40%)', 'PPF (15%)', 'FDs (15%)', 'Liquid Funds (10%)', 'Gold ETFs (10%)', 'NSC (10%)'], values: [40, 15, 15, 10, 10, 10] }, reason: 'Balances growth with stability, using PPF & NSC to maximize Section 80C tax deductions while building a diversified foundation.' },
                { title: 'Growth-Oriented', data: { labels: ['Equity MF (60%)', 'PPF (10%)', 'Liquid Funds (10%)', 'FDs (10%)', 'Gold ETFs (10%)'], values: [60, 10, 10, 10, 10] }, reason: 'Leans into equity to accelerate wealth creation for those with a longer time horizon and higher risk tolerance.' }
            ],
            '15L': [
                { title: 'Balanced Growth & Diversified', data: { labels: ['Equity MF (50%)', 'NPS (15%)', 'Corp. Bonds (10%)', 'Liquid Funds (10%)', 'Gold ETFs (10%)', 'REITs (5%)'], values: [50, 15, 10, 10, 10, 5] }, reason: 'Combines equity growth with debt stability and introduces real estate via REITs for income and diversification.' },
                { title: 'Moderately Aggressive', data: { labels: ['Equity MF (55%)', 'Intl. Equities (10%)', 'NPS (10%)', 'Corp. Bonds (10%)', 'Misc (15%)'], values: [55, 10, 10, 10, 15] }, reason: 'Increases equity exposure and introduces international funds for enhanced growth potential and geographical diversification.' }
            ],
            '20L': [
                { title: 'Aggressive Growth & Diversified', data: { labels: ['Equity MF (60%)', 'Intl. Equities (10%)', 'NPS (10%)', 'Alternatives (15%)', 'Debt (5%)'], values: [60, 10, 10, 15, 5] }, reason: 'Emphasizes high growth through diversified equity and introduces alternative investments like P2P lending to boost returns.' },
                { title: 'Long-Term & Tax-Efficient', data: { labels: ['Equity MF (55%)', 'ELSS (10%)', 'NPS (15%)', 'Corp. Bonds (10%)', 'PPF/NSC (10%)', 'Real Estate (10%)'], values: [55, 10, 15, 10, 10, 10] }, reason: 'Focuses on long-term capital appreciation while strategically utilizing tax-saving instruments like ELSS and a higher NPS allocation.' }
            ],
            '30L': [
                { title: 'High-Growth & Multi-Asset', data: { labels: ['Equity MF (55%)', 'Intl. Equities (15%)', 'NPS (10%)', 'Alternatives (15%)', 'Debt (5%)'], values: [55, 15, 10, 15, 5] }, reason: 'Seeks aggressive growth via broad domestic and international equity, complemented by alternative assets like P2P lending for enhanced returns.' },
                { title: 'Strategic & Tax-Optimized', data: { labels: ['Equity MF (45%)', 'ELSS (10%)', 'NPS (15%)', 'Real Estate (10%)', 'Debt (20%)'], values: [45, 10, 15, 10, 20] }, reason: 'Balances growth with significant tax planning, using ELSS, NPS, and home loan benefits to optimize tax outgo for a higher income bracket.' }
            ],
            '50L': [
                { title: 'Aggressive Wealth Accumulation', data: { labels: ['Equity MF (50%)', 'Intl. Equities (15%)', 'AIFs (10%)', 'NPS (10%)', 'Misc (15%)'], values: [50, 15, 10, 10, 15] }, reason: 'Geared towards maximizing long-term wealth by introducing Alternative Investment Funds (AIFs), accessible to high-income earners.' },
                { title: 'Balanced Growth & Income', data: { labels: ['Equity MF (40%)', 'REITs/InvITs (15%)', 'P2P Lending (10%)', 'Intl. Equity (10%)', 'Debt/NPS (25%)'], values: [40, 15, 10, 10, 25] }, reason: 'Aims for strong balance between capital growth and consistent income streams by increasing allocation to REITs and P2P lending.' }
            ],
            '1Cr': [
                { title: 'Ultra-Aggressive & Sophisticated', data: { labels: ['Equity MF (50%)', 'Intl. Equities (15%)', 'AIFs (15%)', 'Crypto (5%)', 'Misc (15%)'], values: [50, 15, 15, 5, 15] }, reason: 'Designed for maximum appreciation, using AIFs and a speculative crypto allocation for potentially exponential, high-risk growth.' },
                { title: 'Legacy Building', data: { labels: ['Equity MF (40%)', 'Phys. Real Estate (20%)', 'REITs (10%)', 'Intl. Equity (10%)', 'Debt/P2P (20%)'], values: [40, 20, 10, 10, 20] }, reason: 'Focuses on high-value goals by blending equity growth with significant investment in tangible assets like physical real estate.' }
            ]
        };
        
        let portfolioCharts = [];
        function renderPortfolio(incomeKey) {
            const displayDiv = document.getElementById('portfolio-display');
            portfolioCharts.forEach(chart => chart.destroy());
            portfolioCharts = [];
            
            const portfolios = portfolioData[incomeKey];
            let html = '<div class="grid grid-cols-1 md:grid-cols-2 gap-8">';
            portfolios.forEach((p, index) => {
                const chartId = `portfolioChart-${incomeKey}-${index}`;
                html += `
                    <div class="flex flex-col items-center">
                        <h5 class="text-xl font-semibold text-gray-800 mb-2">${p.title}</h5>
                        <div class="small-chart-container">
                            <canvas id="${chartId}"></canvas>
                        </div>
                         <p class="text-sm text-gray-600 mt-4 text-center max-w-sm">${p.reason}</p>
                    </div>
                `;
            });
            html += '</div>';
            displayDiv.innerHTML = html;
            
            portfolios.forEach((p, index) => {
                const chartId = `portfolioChart-${incomeKey}-${index}`;
                const ctx = document.getElementById(chartId).getContext('2d');
                const chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: p.data.labels,
                        datasets: [{
                            data: p.data.values,
                            backgroundColor: ['#43766C', '#76885B', '#B19470', '#F8F4E1', '#A9A9A9', '#6B8E23'],
                            borderColor: '#f8f7f4',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { callbacks: { label: function(context) { return `${context.label}`; } } }
                        }
                    }
                });
                portfolioCharts.push(chart);
            });
        }

        function showPortfolio(incomeKey) {
            renderPortfolio(incomeKey);
            document.querySelectorAll('#investments .portfolio-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.classList.add('bg-gray-200', 'text-gray-700');
            });
            document.querySelector(`#investments .portfolio-tab[onclick="showPortfolio('${incomeKey}')"]`).classList.add('active');
            document.querySelector(`#investments .portfolio-tab[onclick="showPortfolio('${incomeKey}')"]`).classList.remove('bg-gray-200', 'text-gray-700');
        }

        // --- PAYMENT GATEWAY DATA & LOGIC ---
        async function getAiInsights(gatewayName, description, competencies, pros, cons) {
            const insightsDivId = `${gatewayName.toLowerCase().replace(/\s/g, '')}Insights`;
            const insightsDiv = document.getElementById(insightsDivId);
            insightsDiv.classList.remove('hidden');
            insightsDiv.innerHTML = '<p class="text-center text-gray-600">Generating insights... ‚ú®</p>';

            const prompt = `As an expert payment gateway analyst, summarize the key description, competencies, pros, and cons for ${gatewayName} based on the following information:
Description: ${description}
Competencies: ${competencies}
Pros: ${pros}
Cons: ${cons}
Keep the summary concise and highlight the most important aspects.`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    insightsDiv.innerHTML = `<p class="font-semibold mb-2">AI Summary for ${gatewayName}:</p><p>${text}</p>`;
                } else {
                    insightsDiv.innerHTML = '<p class="text-red-600">Error: Could not generate insights. Please try again.</p>';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                insightsDiv.innerHTML = '<p class="text-red-600">Error: Failed to connect to AI service. Please check your network.</p>';
            }
        }

        // --- CASH FLOW DATA & LOGIC ---
        const cashFlowDefinitions = {
            'operations': { title: 'Cash Flow from Operations (CFO)', description: 'This represents the cash generated from a company\'s normal business activities. It indicates how much cash the company produces from its core operations, excluding non-cash expenses like depreciation. A strong positive CFO is a sign of healthy, sustainable business operations.' },
            'investing': { title: 'Cash Flow from Investing (CFI)', description: 'This shows the cash used for or generated from investment activities, such as buying or selling assets (property, plant, equipment), or investments in other companies. Negative CFI often indicates a company is growing by investing in its future, while positive CFI might mean it\'s selling off assets.' },
            'financing': { title: 'Cash Flow from Financing (CFF)', description: 'This reflects the cash flow between a company and its owners/creditors. It includes activities like issuing or repaying debt, issuing or repurchasing stock, and paying dividends. It reveals how a company raises capital and pays back its investors.' },
            'free': { title: 'Free Cash Flow (FCF)', description: 'Free Cash Flow is the cash a company generates after accounting for cash outflows to support operations and maintain its capital assets. It\'s a crucial metric for investors as it shows how much cash a company has left over to pay down debt, pay dividends, or invest in new growth opportunities.' },
            'positive_negative': { title: 'Positive and Negative Cash Flow', description: '<strong>Positive Cash Flow:</strong> Means a company\'s cash inflows exceed its cash outflows. This indicates financial health, liquidity, and ability to grow. <br><strong>Negative Cash Flow:</strong> Means cash outflows exceed inflows. While prolonged negative cash flow can be a red flag, it can also be normal for rapidly growing companies investing heavily, or for seasonal businesses during off-peak periods.' }
        };
        
        function showCashFlowDefinition(key) {
            const contentDiv = document.getElementById('cash-flow-definition-content');
            const definition = cashFlowDefinitions[key];
            contentDiv.innerHTML = `<h5 class="text-xl font-semibold text-gray-800 mb-3">${definition.title}</h5><p class="text-gray-700 text-sm">${definition.description}</p>`;
            
            document.querySelectorAll('#cash-flow .tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            // Set the active class on the clicked/selected button
            document.getElementById(`tab-${key}`).classList.add('active');
            document.getElementById(`tab-${key}`).classList.remove('bg-gray-200', 'text-gray-700');
        }

        let sectoralCashFlowChart = null;
        function renderSectoralCashFlowChart() {
            const ctx = document.getElementById('sectoralCashFlowChart').getContext('2d');
            const data = {
                labels: ['FMCG', 'FMCD', 'BFSI', 'IT Services', 'Automotive', 'Pharma'],
                datasets: [{
                    label: 'CFO Growth (FY24, % YoY)',
                    data: [12, 8, 15, 10, 7, 11],
                    backgroundColor: ['#047857', '#059669', '#10b981', '#34d399', '#6ee7b7', '#a7f3d0'],
                    borderColor: '#f4f5f7',
                    borderWidth: 1
                }]
            };

            if (sectoralCashFlowChart) sectoralCashFlowChart.destroy();
            sectoralCashFlowChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Growth (%)' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { label: function(context) { return `${context.label}: ${context.parsed.y}%`; } } }
                    }
                }
            });
        }

        // --- INITIALIZATION ON LOAD ---
        window.addEventListener('DOMContentLoaded', () => {
            // Stock Market Section Init
            renderStockSelector();
            displayStockDetails('MOTHERSO'); // Default display
            
            // Investment Section Init
            renderAssets('all');
            renderRiskReturnChart();
            showPortfolio('10L'); // Default display

            // Cash Flow Section Init
            showCashFlowDefinition('operations'); // Default display
            renderSectoralCashFlowChart();

            // Sticky Navigation Active State
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.id;
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if(link.getAttribute('href') === `#${id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { rootMargin: "-30% 0px -60% 0px" });

            sections.forEach(section => observer.observe(section));
        });

    </script>
</body>
</html>
